{"ast":null,"code":"import _asyncToGenerator from \"D:/Users/raghavendra/Desktop/ODE/OPTH/New folder/testing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { maxTime, isWithinInterval, startOfDay } from \"date-fns\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@services/state-services/state-passing.service\";\nimport * as i2 from \"@ngx-translate/core\";\nimport * as i3 from \"@services/rest-api-services/calendar.service\";\nimport * as i4 from \"@services/util-services/util.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../header/header/header.component\";\nimport * as i7 from \"../../loading/loading-state/loading-state.component\";\nimport * as i8 from \"ngx-moment\";\nconst _c0 = function (a0) {\n  return {\n    calendar_list_item_active: a0\n  };\n};\nfunction CalendarComponent_div_4_div_1_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"div\", 9)(2, \"h3\", 10);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 11)(6, \"h4\", 12);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const event_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(6, _c0, event_r4.isActive));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(4, 3, event_r4.schedule.startTime, \"shortTime\"), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", event_r4.description, \" \");\n  }\n}\nfunction CalendarComponent_div_4_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"amDateFormat\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, CalendarComponent_div_4_div_1_div_4_Template, 8, 8, \"div\", 7);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 2, item_r2.date, \"ll\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", item_r2.events);\n  }\n}\nfunction CalendarComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, CalendarComponent_div_4_div_1_Template, 5, 5, \"div\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.model.calendarItems);\n  }\n}\nexport let CalendarComponent = /*#__PURE__*/(() => {\n  class CalendarComponent {\n    constructor(appContext, translate, calendar, utils) {\n      this.appContext = appContext;\n      this.translate = translate;\n      this.calendar = calendar;\n      this.utils = utils;\n      this.model = {\n        calendarItems: [],\n        state: \"Loading\"\n      };\n      this.addDescription = event => {\n        switch (event.type) {\n          case \"individual_session\" /* SessionType.IndividualSession */:\n            {\n              const [clinician] = event.party.clinicians;\n              event.description = [event.description, this.translate.instant(\"CALENDAR_WITH\" /* Texts.CalendarWith */), clinician.firstName, clinician.lastName].join(\" \");\n              break;\n            }\n        }\n      };\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const user = _this.appContext.getUser();\n        if (user) {\n          const events = yield _this.calendar.list(user);\n          events.forEach(_this.addDescription);\n          const groupedEvents = _this.groupByDate(events);\n          const calendarItems = _this.createCalendarItems(groupedEvents);\n          _this.model.calendarItems = calendarItems;\n          _this.model.state = \"Loaded\";\n        } else {\n          _this.model.state = \"Failed\";\n        }\n      })();\n    }\n    groupByDate(events) {\n      return this.utils.groupBy(events, ({\n        schedule: {\n          startTime\n        }\n      }) => startOfDay(new Date(startTime)).getTime());\n    }\n    createCalendarItems(groupedEvents) {\n      return Array.from(groupedEvents, ([date, events]) => ({\n        date: new Date(date),\n        events: this.utils.sortBy(events, ({\n          schedule: {\n            startTime\n          }\n        }) => new Date(startTime)).map(event => Object.assign(Object.assign({}, event), {\n          isActive: this.isActive(event)\n        }))\n      })).sort(this.utils.compareBy(({\n        date\n      }) => date));\n    }\n    isActive({\n      schedule: {\n        startTime,\n        endTime\n      }\n    }) {\n      const start = new Date(startTime);\n      const end = new Date(endTime || maxTime);\n      return isWithinInterval(Date.now(), {\n        start,\n        end\n      });\n    }\n  }\n  CalendarComponent.ɵfac = function CalendarComponent_Factory(t) {\n    return new (t || CalendarComponent)(i0.ɵɵdirectiveInject(i1.StatePassingService), i0.ɵɵdirectiveInject(i2.TranslateService), i0.ɵɵdirectiveInject(i3.CalendarService), i0.ɵɵdirectiveInject(i4.Utils));\n  };\n  CalendarComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CalendarComponent,\n    selectors: [[\"app-calendar\"]],\n    decls: 5,\n    vars: 8,\n    consts: [[1, \"container\"], [3, \"title\", \"showBackBtn\"], [\"id\", \"calendar_container\", 1, \"content\"], [3, \"stateModel\", \"hasNoData\", \"noDataMessage\", \"loadingMessage\", \"failedMessage\"], [4, \"ngIf\"], [\"class\", \"calendar_date_container\", 4, \"ngFor\", \"ngForOf\"], [1, \"calendar_date_container\"], [\"id\", \"calendar-event\", \"class\", \"calendar_list_item\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"calendar-event\", 1, \"calendar_list_item\", 3, \"ngClass\"], [1, \"date-area\"], [1, \"calendar_event_date\"], [1, \"description-area\"], [1, \"calendar_event_description\"]],\n    template: function CalendarComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"header-menu\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelement(3, \"loading-state\", 3);\n        i0.ɵɵtemplate(4, CalendarComponent_div_4_Template, 2, 1, \"div\", 4);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"title\", \"SHOW_CALENDAR\")(\"showBackBtn\", true);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"stateModel\", ctx.model.state)(\"hasNoData\", ctx.model.calendarItems.length === 0)(\"noDataMessage\", \"CALENDAR_NO_ITEMS\")(\"loadingMessage\", \"CALENDAR_LOADING\")(\"failedMessage\", \"CALENDAR_FAILED\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.calendarItems.length > 0);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i6.HeaderComponent, i7.LoadingStateComponent, i5.DatePipe, i8.DateFormatPipe]\n  });\n  return CalendarComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}