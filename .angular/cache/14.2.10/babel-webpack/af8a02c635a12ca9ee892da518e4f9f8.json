{"ast":null,"code":"import _asyncToGenerator from \"D:/Users/raghavendra/Desktop/ODE/OPTH/New folder/testing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ElementRef } from '@angular/core';\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@services/state-services/state-passing.service\";\nimport * as i3 from \"@ngx-translate/core\";\nimport * as i4 from \"@services/rest-api-services/questionnaires.service\";\nimport * as i5 from \"@services/rest-api-services/questionnaire-groups.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@services/util-services/util.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"../../header/header/header.component\";\nimport * as i10 from \"ng-multiselect-dropdown\";\nfunction OtherQuestionnairesComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelement(1, \"i\", 21);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"QUESTIONNAIRES_LOADING\"), \" \");\n  }\n}\nfunction OtherQuestionnairesComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelement(1, \"i\", 23);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(3, 1, \"QUESTIONNAIRES_FAILED\"), \" \");\n  }\n}\nfunction OtherQuestionnairesComponent_i_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 24);\n  }\n}\nfunction OtherQuestionnairesComponent_i_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"i\", 25);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    count: a0\n  };\n};\nfunction OtherQuestionnairesComponent_p_30_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, \"OTHER_QUESTIONNAIRES_FOUND_QUESTIONNAIRES\", i0.ɵɵpureFunction1(4, _c0, ctx_r4.model.questionnaires == null ? null : ctx_r4.model.questionnaires.length)), \" \");\n  }\n}\nfunction OtherQuestionnairesComponent_p_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"OTHER_QUESTIONNAIRES_START_SEARCHING_QUESTIONNAIRES\"), \" \");\n  }\n}\nfunction OtherQuestionnairesComponent_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵlistener(\"click\", function OtherQuestionnairesComponent_div_33_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const questionnaire_r7 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.chooseQuestionnaire(questionnaire_r7));\n    });\n    i0.ɵɵelementStart(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const questionnaire_r7 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(questionnaire_r7.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind1(5, 3, \"OTHER_QUESTIONNAIRES_VERSION\"), \": \", questionnaire_r7.version, \" \");\n  }\n}\nexport let OtherQuestionnairesComponent = /*#__PURE__*/(() => {\n  class OtherQuestionnairesComponent {\n    constructor(formBuilder, appContext, translate, questionnaires, questionnaireGroupsService, router, utils, translateService, elementRef) {\n      var _a;\n      this.formBuilder = formBuilder;\n      this.appContext = appContext;\n      this.translate = translate;\n      this.questionnaires = questionnaires;\n      this.questionnaireGroupsService = questionnaireGroupsService;\n      this.router = router;\n      this.utils = utils;\n      this.translateService = translateService;\n      this.elementRef = elementRef;\n      this.model = {\n        state: 'Initial',\n        questionnaires: undefined\n      };\n      this.searchQuestionnairesForm = this.formBuilder.group({\n        questionnaireGroups: ['']\n      });\n      this.questionnaireGroupList = [];\n      this.dropdownSettings = {\n        singleSelection: false,\n        idField: 'link',\n        textField: 'name',\n        searchPlaceholderText: this.translate.instant('SEARCH'),\n        noDataAvailablePlaceholderText: this.translate.instant('NO_DATA_AVAILABLE'),\n        enableCheckAll: false,\n        allowSearchFilter: true\n      };\n      this.title = '';\n      this.searchText = '';\n      this.appContext.requestParams.set('useDefaultAuth', true);\n      this.user = this.appContext.currentUser.get();\n      const patient = this.appContext.getUser();\n      this.title = `${patient.firstName} ${patient.lastName}`;\n      this.searchText = translateService.instant('SEARCH_ALL');\n      (_a = this.searchQuestionnairesForm.get('questionnaireGroups')) === null || _a === void 0 ? void 0 : _a.valueChanges.subscribe(value => {\n        this.searchText = (value === null || value === void 0 ? void 0 : value.length) > 0 ? this.translateService.instant('SEARCH') : this.translateService.instant('SEARCH_ALL');\n      });\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        yield _this.renderQuestionnaireGroups();\n      })();\n    }\n    renderQuestionnaireGroups() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const params = {\n          max: 10000\n        };\n        try {\n          const response = yield _this2.questionnaireGroupsService.list(params);\n          const questionnaireGroupList = response.results;\n          const groupList = [];\n          for (const questionnaireGroup of questionnaireGroupList) {\n            groupList.push({\n              name: questionnaireGroup.name,\n              link: questionnaireGroup.links.questionnaireGroup\n            });\n          }\n          _this2.questionnaireGroupList = groupList;\n        } catch (e) {\n          _this2.model.state = 'Failed';\n          console.error(`Failed to fetch questionnaireGroups due to error: ${e}`);\n        }\n      })();\n    }\n    search() {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        _this3.model.state = 'Loading';\n        _this3.model.questionnaires = [];\n        const params = {\n          max: 10000\n        };\n        const questionnaireGroups = _this3.searchQuestionnairesForm.value.questionnaireGroups;\n        try {\n          if ((questionnaireGroups === null || questionnaireGroups === void 0 ? void 0 : questionnaireGroups.length) > 0) {\n            let questionnaires = [];\n            for (const group of questionnaireGroups) {\n              const response = yield _this3.questionnaireGroupsService.getQuestionnaires(group.link, params);\n              questionnaires = questionnaires.concat(response);\n            }\n            _this3.model.questionnaires = questionnaires;\n          } else {\n            const response = yield _this3.questionnaires.list(_this3.user, params);\n            _this3.model.questionnaires = response.results;\n          }\n          _this3.model.state = 'Loaded';\n        } catch (e) {\n          _this3.model.state = 'Failed';\n          console.error(`Failed to fetch questionnaires due to error: ${e}`);\n        }\n      })();\n    }\n    chooseQuestionnaire(questionnaireRef) {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        questionnaireRef.marked = false;\n        _this4.appContext.requestParams.set('selectedQuestionnaire', questionnaireRef);\n        const selected = _this4.utils.urlToId(questionnaireRef.links.questionnaire);\n        _this4.appContext.requestParams.set('questionnaireId', selected);\n        _this4.router.navigate(['questionnaires', selected, 'questionnaire']);\n      })();\n    }\n    closeMultiselect() {\n      this.elementRef.nativeElement.querySelector('#questionnaire-groups-label').click();\n    }\n    get questionnaireGroups() {\n      return this.searchQuestionnairesForm.get('questionnaireGroups');\n    }\n  }\n  OtherQuestionnairesComponent.ɵfac = function OtherQuestionnairesComponent_Factory(t) {\n    return new (t || OtherQuestionnairesComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.StatePassingService), i0.ɵɵdirectiveInject(i3.TranslateService), i0.ɵɵdirectiveInject(i4.QuestionnairesService), i0.ɵɵdirectiveInject(i5.QuestionnaireGroupsService), i0.ɵɵdirectiveInject(i6.Router), i0.ɵɵdirectiveInject(i7.Utils), i0.ɵɵdirectiveInject(i3.TranslateService), i0.ɵɵdirectiveInject(i0.ElementRef));\n  };\n  OtherQuestionnairesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OtherQuestionnairesComponent,\n    selectors: [[\"app-other-questionnaires\"]],\n    decls: 34,\n    vars: 29,\n    consts: [[1, \"container\"], [3, \"title\", \"showChangePasswordBtn\", \"showBackBtn\", \"showLogoutBtn\", \"showHomeBtn\"], [\"id\", \"notification-other-questionnaire-loading\", \"class\", \"notification info\", 4, \"ngIf\"], [\"id\", \"notification-other-questionnaire-failed\", \"class\", \"notification error\", 4, \"ngIf\"], [1, \"content\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"card\"], [1, \"header\"], [\"aria-hidden\", \"true\", 1, \"icon\", \"fa\", \"fa-stethoscope\"], [1, \"form-group\"], [\"for\", \"questionnaire-groups\", \"id\", \"questionnaire-groups-label\"], [\"formControlName\", \"questionnaireGroups\", \"id\", \"questionnaire-groups\", 3, \"placeholder\", \"settings\", \"data\", \"onSelect\", \"onSelectAll\", \"onDeSelect\"], [1, \"form-group-margin-top\"], [\"id\", \"search\", \"type\", \"submit\", 1, \"contained-btn\", 3, \"disabled\"], [\"class\", \"fa fa-search\", 4, \"ngIf\"], [\"class\", \"fa fa-spinner fa-spin\", 4, \"ngIf\"], [\"aria-hidden\", \"true\", 1, \"icon\", \"fas\", \"fa-list\"], [4, \"ngIf\"], [1, \"card-list\"], [\"class\", \"card-list-item\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"notification-other-questionnaire-loading\", 1, \"notification\", \"info\"], [1, \"notification_icon\", \"fas\", \"fa-info-circle\"], [\"id\", \"notification-other-questionnaire-failed\", 1, \"notification\", \"error\"], [1, \"notification_icon\", \"fas\", \"fa-exclamation-triangle\"], [1, \"fa\", \"fa-search\"], [1, \"fa\", \"fa-spinner\", \"fa-spin\"], [1, \"card-list-item\", 3, \"click\"]],\n    template: function OtherQuestionnairesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelement(1, \"header-menu\", 1);\n        i0.ɵɵtemplate(2, OtherQuestionnairesComponent_div_2_Template, 4, 3, \"div\", 2);\n        i0.ɵɵtemplate(3, OtherQuestionnairesComponent_div_3_Template, 4, 3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"nav\", 4)(5, \"form\", 5);\n        i0.ɵɵlistener(\"ngSubmit\", function OtherQuestionnairesComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.search();\n        });\n        i0.ɵɵelementStart(6, \"div\", 6)(7, \"div\", 7)(8, \"h2\");\n        i0.ɵɵelement(9, \"i\", 8);\n        i0.ɵɵtext(10);\n        i0.ɵɵpipe(11, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 9)(13, \"label\", 10);\n        i0.ɵɵtext(14);\n        i0.ɵɵpipe(15, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"ng-multiselect-dropdown\", 11);\n        i0.ɵɵlistener(\"onSelect\", function OtherQuestionnairesComponent_Template_ng_multiselect_dropdown_onSelect_16_listener() {\n          return ctx.closeMultiselect();\n        })(\"onSelectAll\", function OtherQuestionnairesComponent_Template_ng_multiselect_dropdown_onSelectAll_16_listener() {\n          return ctx.closeMultiselect();\n        })(\"onDeSelect\", function OtherQuestionnairesComponent_Template_ng_multiselect_dropdown_onDeSelect_16_listener() {\n          return ctx.closeMultiselect();\n        });\n        i0.ɵɵpipe(17, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\", 12)(19, \"button\", 13);\n        i0.ɵɵtext(20);\n        i0.ɵɵtemplate(21, OtherQuestionnairesComponent_i_21_Template, 1, 0, \"i\", 14);\n        i0.ɵɵtemplate(22, OtherQuestionnairesComponent_i_22_Template, 1, 0, \"i\", 15);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(23, \"br\")(24, \"hr\");\n        i0.ɵɵelementStart(25, \"div\", 7)(26, \"h2\");\n        i0.ɵɵelement(27, \"i\", 16);\n        i0.ɵɵtext(28);\n        i0.ɵɵpipe(29, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(30, OtherQuestionnairesComponent_p_30_Template, 3, 6, \"p\", 17);\n        i0.ɵɵtemplate(31, OtherQuestionnairesComponent_p_31_Template, 3, 3, \"p\", 17);\n        i0.ɵɵelementStart(32, \"div\", 18);\n        i0.ɵɵtemplate(33, OtherQuestionnairesComponent_div_33_Template, 6, 5, \"div\", 19);\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"title\", ctx.title)(\"showChangePasswordBtn\", false)(\"showBackBtn\", true)(\"showLogoutBtn\", false)(\"showHomeBtn\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state === \"Loading\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state === \"Failed\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formGroup\", ctx.searchQuestionnairesForm);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(11, 21, \"QUESTIONNAIRES\"), \" \");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(15, 23, \"OTHER_QUESTIONNAIRES_QUESTIONNAIRE_GROUPS\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"placeholder\", i0.ɵɵpipeBind1(17, 25, \"OTHER_QUESTIONNAIRES_QUESTIONNAIRE_GROUPS\"))(\"settings\", ctx.dropdownSettings)(\"data\", ctx.questionnaireGroupList);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.model.state === \"Loading\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\" \\u00A0 \", ctx.model.state !== \"Loading\" ? ctx.searchText : \"\", \" \\u00A0 \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state !== \"Loading\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state === \"Loading\");\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(29, 27, \"RESULTS\"), \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state === \"Loaded\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.model.state !== \"Loaded\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.model.questionnaires);\n      }\n    },\n    dependencies: [i8.NgForOf, i8.NgIf, i9.HeaderComponent, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i10.MultiSelectComponent, i3.TranslatePipe]\n  });\n  return OtherQuestionnairesComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}