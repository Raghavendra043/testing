"use strict";(self.webpackChunkopentele_client_html_angular=self.webpackChunkopentele_client_html_angular||[]).push([[592],{9797:(g,l,e)=>{e.d(l,{X:()=>d});var t=e(5e3),s=e(60),n=e(1786);function a(r,m){if(1&r&&(t.TgZ(0,"div",3),t._UZ(1,"i",4),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&r){const u=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,1,u.loadingMessage),"\n")}}function o(r,m){if(1&r&&(t.TgZ(0,"div",5),t._UZ(1,"i",4),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&r){const u=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,1,u.noDataMessage),"\n")}}function i(r,m){if(1&r&&(t.TgZ(0,"div",6),t._UZ(1,"i",7),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&r){const u=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,1,u.failedMessage),"\n")}}let d=(()=>{class r{constructor(){this.stateModel="Loading",this.noDataMessage="",this.loadingMessage="",this.failedMessage=""}}return r.\u0275fac=function(u){return new(u||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["loading-state"]],inputs:{stateModel:"stateModel",hasNoData:"hasNoData",noDataMessage:"noDataMessage",loadingMessage:"loadingMessage",failedMessage:"failedMessage"},decls:3,vars:3,consts:[["id","notification-loading","class","notification info",4,"ngIf"],["id","notification-no-data","class","notification info",4,"ngIf"],["id","notification-error","class","notification error",4,"ngIf"],["id","notification-loading",1,"notification","info"],[1,"notification_icon","fas","fa-info-circle"],["id","notification-no-data",1,"notification","info"],["id","notification-error",1,"notification","error"],[1,"notification_icon","fas","fa-exclamation-triangle"]],template:function(u,M){1&u&&(t.YNc(0,a,4,3,"div",0),t.YNc(1,o,4,3,"div",1),t.YNc(2,i,4,3,"div",2)),2&u&&(t.Q6J("ngIf","Loading"===M.stateModel),t.xp6(1),t.Q6J("ngIf","Loaded"===M.stateModel&&M.hasNoData),t.xp6(1),t.Q6J("ngIf","Failed"===M.stateModel))},dependencies:[s.O5,n.X$]}),r})()},1231:(g,l,e)=>{e.d(l,{F:()=>a});var t=e(60),s=e(4466),n=e(5e3);let a=(()=>{class o{}return o.\u0275fac=function(d){return new(d||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[t.ez,s.m]}),o})()},2914:(g,l,e)=>{e.d(l,{t:()=>i});var t=e(5e3),s=e(60),n=e(1786);function a(d,r){if(1&d&&(t.TgZ(0,"div",2),t._UZ(1,"i",3),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&d){const m=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,1,m.info))}}function o(d,r){if(1&d&&(t.TgZ(0,"div",4),t._UZ(1,"i",5),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&d){const m=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,1,m.error))}}let i=(()=>{class d{constructor(){this.info=void 0,this.error=void 0}}return d.\u0275fac=function(m){return new(m||d)},d.\u0275cmp=t.Xpm({type:d,selectors:[["notifications"]],inputs:{info:"info",error:"error"},decls:2,vars:2,consts:[["class","notification info",4,"ngIf"],["class","notification error",4,"ngIf"],[1,"notification","info"],[1,"notification_icon","fas","fa-info-circle"],[1,"notification","error"],[1,"notification_icon","fas","fa-exclamation-triangle"]],template:function(m,u){1&m&&(t.YNc(0,a,5,3,"div",0),t.YNc(1,o,5,3,"div",1)),2&m&&(t.Q6J("ngIf",void 0!==u.info&&void 0===u.error),t.xp6(1),t.Q6J("ngIf",void 0!==u.error))},dependencies:[s.O5,n.X$]}),d})()},6793:(g,l,e)=>{e.d(l,{h:()=>s});var t=e(5e3);let s=(()=>{class n{transform(o,i=!0){return o&&i?`severity-${o}`:"severity-none"}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275pipe=t.Yjl({name:"severity",type:n,pure:!0}),n})()},5969:(g,l,e)=>{e.d(l,{W:()=>m});var t=e(520),s=e(2826),n=e(3175),a=e(1480),o=e(9808),i=e(5e3),d=e(8351),r=e(4338);let m=(()=>{class u{constructor(h,O,v){this.http=h,this.configService=O,this.appContext=v,this.jwtHelper=new n.N0,this.permissions=["write: tokens"],this.appConfig=this.configService.getAppConfig()}getToken(h){const O=(0,a.E)(this.appConfig.baseUrl,"idp2/tokens"),v={context:(new t.qT).set(s.Hq,!0)};return(0,o.n)(this.http.post(O,{links:{patient:h}},v))}clinicianHasPermissions(){const h=this.appContext.requestParams.get("authorizationHeader");if(h){const O=this.jwtHelper.decodeToken(h);for(const v of this.permissions)if(!O.perm.includes(v))return!1;return!0}return!1}}return u.\u0275fac=function(h){return new(h||u)(i.LFG(t.eN),i.LFG(d.E),i.LFG(r.P))},u.\u0275prov=i.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},5349:(g,l,e)=>{e.d(l,{g:()=>I});var t=e(520),s=e(2826),n=e(9808),a=e(4004),o=e(9646),i=e(5577),d=e(9751),r=e(2076),m=e(7359),u=e(4482);const h=(p,f)=>(p.push(f),p);var v=e(5e3),T=e(4679);let I=(()=>{class p{constructor(c,_){this.http=c,this.utils=_}list(c,_){if(!this.utils.exists(c.links.threads))throw new TypeError("User object does not contain a link relation to messageThreads");return(0,n.n)(this.http.get(c.links.threads,{context:(new t.qT).set(s.SF,!0).set(s.Hq,_)}))}get(c){return(0,n.n)(this.http.get(c.links.thread))}markAsRead(c){const _=new t.WM({"Content-Type":"application/json"});return(0,n.n)(this.http.post(c.links.thread+"/read","",{context:(new t.qT).set(s.SF,!0),headers:_}))}getMessages(c){return(0,n.n)(this.http.get(c.links.messages).pipe((0,a.U)(_=>_.results)))}postAttachment(c,_){if(!_||!this.utils.exists(c.links.attachments))return(0,o.of)();const E=new t.WM({"Content-Type":_.type});return this.http.post(c.links.attachments,_,{headers:E,observe:"response"}).pipe((0,a.U)(D=>{const P=D.headers.get("location");if(!this.utils.exists(P))throw new Error("Unable to submit attachment");return P}))}deleteAttachment(c){return this.http.delete(c)}getAttachmentDataUrl(c){return this.http.get(c,{responseType:"blob",context:(new t.qT).set(s.SF,!0).set(s.Hq,!0)}).pipe((0,i.z)(_=>{const E=new FileReader;return new d.y(D=>{E.onload=()=>{D.next(E.result),D.complete()},E.readAsDataURL(_)})}))}create(c,_,E,D){const P=c.links.messages;if(!this.utils.exists(P))throw new TypeError("User does not have any messages");return(0,r.D)(D).pipe((0,i.z)(y=>this.postAttachment(c,y)),function O(){return(0,u.e)((p,f)=>{(function M(p,f){return(0,u.e)((0,m.U)(p,f,arguments.length>=2,!1,!0))})(h,[])(p).subscribe(f)})}(),(0,i.z)(y=>this.postMessage({body:E,sender:{name:`${c.firstName} ${c.lastName}`,type:"patient"},links:{organization:_,patient:c.links.self,attachments:y}},P)))}postMessage(c,_){const E=new t.WM({"Content-Type":"application/json"});return this.http.post(_,c,{context:(new t.qT).set(s.Hq,!0),headers:E}).pipe((0,a.U)(()=>{}))}}return p.\u0275fac=function(c){return new(c||p)(v.LFG(t.eN),v.LFG(T.c))},p.\u0275prov=v.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},8288:(g,l,e)=>{e.d(l,{t:()=>O});var t=e(8115),n=e(8405),a=e(9756),o=e(833),i=e(1998),r=e(520),m=e(2826),u=e(4004),M=e(5e3),h=e(4679);let O=(()=>{class v{constructor(I,p){this.utils=I,this.http=p,this.toScheduleSummaries=f=>{const c=f.questionnaireSchedules,_=f.onlyShowOnAnsweringDay,E=function s(){return(0,t.Z)(Date.now())}();return c.filter(D=>{const P=this.utils.exists(D.nextDeadline)&&(0,n.Z)(E,new Date(D.nextDeadline));return!_||"UNSCHEDULED"===D.type||P}).map(this.toSummary)},this.toSummary=f=>{const c=this.utils.exists(f.nextDeadline)?new Date(f.nextDeadline):void 0;let _;this.utils.exists(c)&&this.utils.exists(f.scheduleWindowMinutes)&&(_=function d(v,T){(0,o.Z)(2,arguments);var I=(0,i.Z)(T);return(0,a.Z)(v,-I)}(c,f.scheduleWindowMinutes));const[E]=f.links.questionnaire.split("/").reverse().map(Number).filter(P=>!Number.isNaN(P));let D;return this.utils.exists(f.scheduledTime)&&(D=f.scheduledTime.reminderStartMinutes),Object.assign(Object.assign(Object.assign({name:f.questionnaireName,questionnaireId:E},_?{scheduleWindowStart:_}:{}),D?{reminderStartMinutes:D}:{}),c?{nextDeadline:c}:{})},this.list=(f,c)=>{if(!this.utils.exists(f.links.questionnaireSchedules))throw new TypeError("User object does not contain a link relation to questionnaireSchedules");const _=(new r.qT).set(m.SF,!0).set(m.Hq,c);return this.http.get(f.links.questionnaireSchedules,{context:_}).pipe((0,u.U)(this.toScheduleSummaries))}}}return v.\u0275fac=function(I){return new(I||v)(M.LFG(h.c),M.LFG(r.eN))},v.\u0275prov=M.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},833:(g,l,e)=>{function t(s,n){if(n.length<s)throw new TypeError(s+" argument"+(s>1?"s":"")+" required, but only "+n.length+" present")}e.d(l,{Z:()=>t})},1998:(g,l,e)=>{function t(s){if(null===s||!0===s||!1===s)return NaN;var n=Number(s);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}e.d(l,{Z:()=>t})},5650:(g,l,e)=>{e.d(l,{Z:()=>a});var t=e(1998),s=e(953),n=e(833);function a(o,i){(0,n.Z)(2,arguments);var d=(0,s.Z)(o),r=(0,t.Z)(i);return isNaN(r)?new Date(NaN):(r&&d.setDate(d.getDate()+r),d)}},1201:(g,l,e)=>{e.d(l,{Z:()=>a});var t=e(1998),s=e(953),n=e(833);function a(o,i){(0,n.Z)(2,arguments);var d=(0,s.Z)(o).getTime(),r=(0,t.Z)(i);return new Date(d+r)}},9756:(g,l,e)=>{e.d(l,{Z:()=>o});var t=e(1998),s=e(1201),n=e(833);function o(i,d){(0,n.Z)(2,arguments);var r=(0,t.Z)(d);return(0,s.Z)(i,6e4*r)}},4185:(g,l,e)=>{e.d(l,{Z:()=>a});var t=e(1998),s=e(5650),n=e(833);function a(o,i){(0,n.Z)(2,arguments);var d=(0,t.Z)(i),r=7*d;return(0,s.Z)(o,r)}},8779:(g,l,e)=>{e.d(l,{Z:()=>n});var t=e(953),s=e(833);function n(a,o){(0,s.Z)(2,arguments);var i=(0,t.Z)(a),d=(0,t.Z)(o),r=i.getTime()-d.getTime();return r<0?-1:r>0?1:r}},5566:(g,l,e)=>{e.d(l,{LI:()=>n,QI:()=>d,qk:()=>i,vh:()=>o,yJ:()=>a});var n=24*Math.pow(10,8)*60*60*1e3,a=6e4,o=36e5,i=1e3,d=-n},8405:(g,l,e)=>{e.d(l,{Z:()=>n});var t=e(8115),s=e(833);function n(a,o){(0,s.Z)(2,arguments);var i=(0,t.Z)(a),d=(0,t.Z)(o);return i.getTime()===d.getTime()}},8115:(g,l,e)=>{e.d(l,{Z:()=>n});var t=e(953),s=e(833);function n(a){(0,s.Z)(1,arguments);var o=(0,t.Z)(a);return o.setHours(0,0,0,0),o}},737:(g,l,e)=>{e.d(l,{Z:()=>a});var t=e(1998),s=e(4185),n=e(833);function a(o,i){(0,n.Z)(2,arguments);var d=(0,t.Z)(i);return(0,s.Z)(o,-d)}},953:(g,l,e)=>{e.d(l,{Z:()=>n});var t=e(833);function s(a){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(i){return typeof i}:function(i){return i&&"function"==typeof Symbol&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(a)}function n(a){(0,t.Z)(1,arguments);var o=Object.prototype.toString.call(a);return a instanceof Date||"object"===s(a)&&"[object Date]"===o?new Date(a.getTime()):"number"==typeof a||"[object Number]"===o?new Date(a):(("string"==typeof a||"[object String]"===o)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}}}]);