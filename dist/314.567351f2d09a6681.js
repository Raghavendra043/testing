"use strict";(self.webpackChunkopentele_client_html_angular=self.webpackChunkopentele_client_html_angular||[]).push([[314],{314:(j,m,a)=>{a.r(m),a.d(m,{ClinicianMenuModule:()=>R});var u=a(60),d=a(619),p=a(5861),t=a(5e3),h=a(4338),g=a(2279),C=a(5969),l=a(3075),A=a(4879),Z=a(4865),v=a(7166),N=a(8507),T=a(1786);function I(e,o){1&e&&(t.TgZ(0,"div",29),t._UZ(1,"i",30),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"CLINICIAN_PERMISSION_WARNING")," "))}function _(e,o){1&e&&(t.TgZ(0,"div",31),t._UZ(1,"i",30),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"CLINICIAN_MENU_FAILED")," "))}function U(e,o){1&e&&t._UZ(0,"i",32)}function E(e,o){1&e&&t._UZ(0,"i",33)}const M=function(e){return{count:e}};function x(e,o){if(1&e&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,"CLINICIAN_MENU_FOUND_PATIENTS",t.VKq(4,M,null==n.model.patients?null:n.model.patients.length))," ")}}function L(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CLINICIAN_MENU_START_SEARCHING_PATIENTS")," "))}function P(e,o){if(1&e){const n=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){const r=t.CHM(n).$implicit,c=t.oxw();return t.KtG(c.choosePatient(r))}),t.TgZ(1,"h3"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}if(2&e){const n=o.$implicit;t.xp6(2),t.AsE("",n.firstName," ",n.lastName,""),t.xp6(2),t.AsE(" ",t.lcZ(5,4,"CREATE_PATIENT_UNIQUE_ID"),": ",n.uniqueId," ")}}const f=function(e){return{warning:e}},S=[{path:"",component:(()=>{class e{constructor(n,i,s,r,c,Y,O,Q){this.appContext=n,this.patientService=i,this.idp2Service=s,this.router=r,this.formBuilder=c,this.authentication=Y,this.userSession=O,this.idle=Q,this.searchPatientForm=this.formBuilder.group({firstName:[""],lastName:[""],uniqueId:[""],phone:[""]}),this.model={state:"Initial",patients:void 0,canChangePassword:!1},this.hasPermissions=!1,this.startIdleWatcher(),this.user=this.appContext.currentUser.get(),this.hasPermissions=this.idp2Service.clinicianHasPermissions()}search(){var n=this;return(0,p.Z)(function*(){n.model.state="Loading";const i=n.searchPatientForm.value;i.max=1e4;try{const s=yield n.patientService.find(n.user,i);n.model.state="Loaded",n.model.patients=s.results}catch(s){n.model.state="Failed",console.error(`Failed to fetch patients due to error: ${s}`)}})()}goCreatePatient(n){n.preventDefault(),this.router.navigate(["/create_patient"])}choosePatient(n){var i=this;return(0,p.Z)(function*(){let s;try{const r=yield i.idp2Service.getToken(n.links.patient);i.authentication.patientAuthHeader(r.type+" "+r.token);const c=yield i.patientService.currentPatient(n);s=i.userSession.setPatientUser(c,r),s&&(i.appContext.requestParams.set("selectedPatient",s),i.router.navigate(["/menu"]))}catch(r){i.model.state="Failed",console.error(`Failed to fetch patient due to error: ${r}`),console.error(JSON.stringify(r))}})()}startIdleWatcher(){this.idle.isRunning()||this.idle.watch()}get firstName(){return this.searchPatientForm.get("firstName")}get lastName(){return this.searchPatientForm.get("firstName")}get uniqueId(){return this.searchPatientForm.get("uniqueId")}get phone(){return this.searchPatientForm.get("phone")}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(h.P),t.Y36(g.e),t.Y36(C.W),t.Y36(d.F0),t.Y36(l.qu),t.Y36(A.$),t.Y36(Z.o),t.Y36(v.hX))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-clinician-menu"]],decls:57,vars:41,consts:[[1,"container"],[3,"title","showLogoutBtn"],["id","notification-permission-warning","class","notification warning",4,"ngIf"],["id","notification-clinician-menu-error","class","notification error",4,"ngIf"],[1,"content"],[3,"formGroup","ngSubmit"],[1,"card"],[1,"header"],["aria-hidden","true",1,"icon","fas","fa-users"],[1,"card-group"],[1,"form-group"],["for","first-name"],["id","first-name","name","first-name","type","text","autocomplete","off","autocorrect","off","autocapitalize","off","formControlName","firstName",3,"ngClass"],["for","last-name"],["id","last-name","name","last-name","type","text","autocomplete","off","autocorrect","off","autocapitalize","off","formControlName","lastName",3,"ngClass"],["for","unique-id"],["id","unique-id","name","unique-id","type","text","autocomplete","off","autocorrect","off","autocapitalize","off","formControlName","uniqueId"],["for","phone"],["id","phone","name","phone","type","text","autocomplete","off","autocorrect","off","autocapitalize","off","formControlName","phone"],[1,"card-group-margin"],["type","submit","id","submit",1,"contained-btn",3,"disabled"],["class","fa fa-search",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],["id","create",1,"contained-create-btn",3,"click"],["aria-hidden","true",1,"icon","fas","fa-user-plus"],["aria-hidden","true",1,"icon","fas","fa-list"],[4,"ngIf"],[1,"card-list"],["class","card-list-item",3,"click",4,"ngFor","ngForOf"],["id","notification-permission-warning",1,"notification","warning"],[1,"notification_icon","fas","fa-exclamation-triangle"],["id","notification-clinician-menu-error",1,"notification","error"],[1,"fa","fa-search"],[1,"fa","fa-spinner","fa-spin"],[1,"card-list-item",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"header-menu",1),t.YNc(2,I,4,3,"div",2),t.YNc(3,_,4,3,"div",3),t.TgZ(4,"nav",4)(5,"form",5),t.NdJ("ngSubmit",function(){return i.search()}),t.TgZ(6,"div",6)(7,"div",7)(8,"h2"),t._UZ(9,"i",8),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div",9)(13,"div",10)(14,"label",11),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"input",12),t.qZA(),t.TgZ(18,"div",10)(19,"label",13),t._uU(20),t.ALo(21,"translate"),t.qZA(),t._UZ(22,"input",14),t.qZA()(),t.TgZ(23,"div",9)(24,"div",10)(25,"label",15),t._uU(26),t.ALo(27,"translate"),t.qZA(),t._UZ(28,"input",16),t.qZA(),t.TgZ(29,"div",10)(30,"label",17),t._uU(31),t.ALo(32,"translate"),t.qZA(),t._UZ(33,"input",18),t.qZA()(),t.TgZ(34,"div",19)(35,"div",10)(36,"button",20),t._uU(37),t.ALo(38,"translate"),t.YNc(39,U,1,0,"i",21),t.YNc(40,E,1,0,"i",22),t.qZA()(),t.TgZ(41,"div",10)(42,"button",23),t.NdJ("click",function(r){return i.goCreatePatient(r)}),t._uU(43),t.ALo(44,"translate"),t._UZ(45,"i",24),t.qZA()()(),t._UZ(46,"br")(47,"hr"),t.TgZ(48,"div",7)(49,"h2"),t._UZ(50,"i",25),t._uU(51),t.ALo(52,"translate"),t.qZA()(),t.YNc(53,x,3,6,"p",26),t.YNc(54,L,3,3,"p",26),t.TgZ(55,"div",27),t.YNc(56,P,6,6,"div",28),t.qZA()()()()()),2&n&&(t.xp6(1),t.Q6J("title","CLINICIAN_MENU")("showLogoutBtn",!0),t.xp6(1),t.Q6J("ngIf",!i.hasPermissions),t.xp6(1),t.Q6J("ngIf","Failed"===i.model.state),t.xp6(2),t.Q6J("formGroup",i.searchPatientForm),t.xp6(5),t.hij(" ",t.lcZ(11,21,"PATIENTS_LIST")," "),t.xp6(5),t.Oqu(t.lcZ(16,23,"CREATE_PATIENT_FIRST_NAME")),t.xp6(2),t.Q6J("ngClass",t.VKq(37,f,!i.firstName.valid&&!i.firstName.pristine)),t.xp6(3),t.Oqu(t.lcZ(21,25,"CREATE_PATIENT_LAST_NAME")),t.xp6(2),t.Q6J("ngClass",t.VKq(39,f,!i.lastName.valid&&!i.lastName.pristine)),t.xp6(4),t.Oqu(t.lcZ(27,27,"CREATE_PATIENT_UNIQUE_ID")),t.xp6(5),t.Oqu(t.lcZ(32,29,"CREATE_PATIENT_PHONE")),t.xp6(5),t.Q6J("disabled","Loading"===i.model.state),t.xp6(1),t.hij(" ","Loading"!==i.model.state?t.lcZ(38,31,"SEARCH"):""," "),t.xp6(2),t.Q6J("ngIf","Loading"!==i.model.state),t.xp6(1),t.Q6J("ngIf","Loading"===i.model.state),t.xp6(3),t.hij(" ",t.lcZ(44,33,"CREATE")," "),t.xp6(8),t.hij("",t.lcZ(52,35,"RESULTS")," "),t.xp6(2),t.Q6J("ngIf","Loaded"===i.model.state),t.xp6(1),t.Q6J("ngIf","Loaded"!==i.model.state),t.xp6(2),t.Q6J("ngForOf",i.model.patients))},dependencies:[u.mk,u.sg,u.O5,N.G,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,T.X$]}),e})()}];let F=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.Bz.forChild(S),d.Bz]}),e})();var J=a(4546),q=a(4466),y=a(9017);let R=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,F,J.O,q.m,y.I,l.UX]}),e})()}}]);