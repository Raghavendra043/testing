"use strict";(self.webpackChunkopentele_client_html_angular=self.webpackChunkopentele_client_html_angular||[]).push([[398],{398:(b,f,a)=>{a.r(f),a.d(f,{CalendarModule:()=>N});var t=a(60),C=a(619),_=a(5861),T=a(8115),g=a(5566),v=a(953),A=a(833),n=a(5e3),D=a(4338),I=a(1786),M=a(9808),x=a(520);let O=(()=>{class o{constructor(e){this.http=e}list(e){var r=this;return(0,_.Z)(function*(){var l;if(console.debug("Requesting list of events"),void 0===(null===(l=null==e?void 0:e.links)||void 0===l?void 0:l.calendar))throw TypeError("User object does not contain a link relation to calendar");const u=(0,T.Z)(new Date),p=`${e.links.calendar}?from_date=${u.toISOString}`,{results:E}=yield(0,M.n)(r.http.get(p));return E})()}}return o.\u0275fac=function(e){return new(e||o)(n.LFG(x.eN))},o.\u0275prov=n.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var L=a(4679),Z=a(8507),i=a(9797),m=a(8348);const s=function(o){return{calendar_list_item_active:o}};function h(o,c){if(1&o&&(n.TgZ(0,"div",8)(1,"div",9)(2,"h3",10),n._uU(3),n.ALo(4,"date"),n.qZA()(),n.TgZ(5,"div",11)(6,"h4",12),n._uU(7),n.qZA()()()),2&o){const e=c.$implicit;n.Q6J("ngClass",n.VKq(6,s,e.isActive)),n.xp6(3),n.hij(" ",n.xi3(4,3,e.schedule.startTime,"shortTime")," "),n.xp6(4),n.hij(" ",e.description," ")}}function d(o,c){if(1&o&&(n.TgZ(0,"div",6)(1,"h3"),n._uU(2),n.ALo(3,"amDateFormat"),n.qZA(),n.YNc(4,h,8,8,"div",7),n.qZA()),2&o){const e=c.$implicit;n.xp6(2),n.Oqu(n.xi3(3,2,e.date,"ll")),n.xp6(2),n.Q6J("ngForOf",e.events)}}function H(o,c){if(1&o&&(n.TgZ(0,"div"),n.YNc(1,d,5,5,"div",5),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.Q6J("ngForOf",e.model.calendarItems)}}const y=[{path:"",component:(()=>{class o{constructor(e,r,l,u){this.appContext=e,this.translate=r,this.calendar=l,this.utils=u,this.model={calendarItems:[],state:"Loading"},this.addDescription=p=>{switch(p.type){case"individual_session":{const[E]=p.party.clinicians;p.description=[p.description,this.translate.instant("CALENDAR_WITH"),E.firstName,E.lastName].join(" ");break}}}}ngOnInit(){var e=this;return(0,_.Z)(function*(){const r=e.appContext.getUser();if(r){const l=yield e.calendar.list(r);l.forEach(e.addDescription);const u=e.groupByDate(l),p=e.createCalendarItems(u);e.model.calendarItems=p,e.model.state="Loaded"}else e.model.state="Failed"})()}groupByDate(e){return this.utils.groupBy(e,({schedule:{startTime:r}})=>(0,T.Z)(new Date(r)).getTime())}createCalendarItems(e){return Array.from(e,([r,l])=>({date:new Date(r),events:this.utils.sortBy(l,({schedule:{startTime:u}})=>new Date(u)).map(u=>Object.assign(Object.assign({},u),{isActive:this.isActive(u)}))})).sort(this.utils.compareBy(({date:r})=>r))}isActive({schedule:{startTime:e,endTime:r}}){const l=new Date(e),u=new Date(r||g.LI);return function B(o,c){(0,A.Z)(2,arguments);var e=(0,v.Z)(o).getTime(),r=(0,v.Z)(c.start).getTime(),l=(0,v.Z)(c.end).getTime();if(!(r<=l))throw new RangeError("Invalid interval");return e>=r&&e<=l}(Date.now(),{start:l,end:u})}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(D.P),n.Y36(I.sK),n.Y36(O),n.Y36(L.c))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-calendar"]],decls:5,vars:8,consts:[[1,"container"],[3,"title","showBackBtn"],["id","calendar_container",1,"content"],[3,"stateModel","hasNoData","noDataMessage","loadingMessage","failedMessage"],[4,"ngIf"],["class","calendar_date_container",4,"ngFor","ngForOf"],[1,"calendar_date_container"],["id","calendar-event","class","calendar_list_item",3,"ngClass",4,"ngFor","ngForOf"],["id","calendar-event",1,"calendar_list_item",3,"ngClass"],[1,"date-area"],[1,"calendar_event_date"],[1,"description-area"],[1,"calendar_event_description"]],template:function(e,r){1&e&&(n.TgZ(0,"div",0),n._UZ(1,"header-menu",1),n.TgZ(2,"div",2),n._UZ(3,"loading-state",3),n.YNc(4,H,2,1,"div",4),n.qZA()()),2&e&&(n.xp6(1),n.Q6J("title","SHOW_CALENDAR")("showBackBtn",!0),n.xp6(2),n.Q6J("stateModel",r.model.state)("hasNoData",0===r.model.calendarItems.length)("noDataMessage","CALENDAR_NO_ITEMS")("loadingMessage","CALENDAR_LOADING")("failedMessage","CALENDAR_FAILED"),n.xp6(1),n.Q6J("ngIf",r.model.calendarItems.length>0))},dependencies:[t.mk,t.sg,t.O5,Z.G,i.X,t.uU,m.Ek]}),o})()}];let F=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[C.Bz.forChild(y),C.Bz]}),o})();var w=a(4546),P=a(4466),U=a(9017);let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[t.ez,F,w.O,P.m,U.I]}),o})()},4546:(b,f,a)=>{a.d(f,{O:()=>T});var t=a(60),C=a(4466),_=a(5e3);let T=(()=>{class g{}return g.\u0275fac=function(A){return new(A||g)},g.\u0275mod=_.oAB({type:g}),g.\u0275inj=_.cJS({imports:[t.ez,C.m]}),g})()},8507:(b,f,a)=>{a.d(f,{G:()=>Z});var t=a(5e3),C=a(619),_=a(1786),T=a(7362),g=a(4338),v=a(8351),A=a(4879),B=a(60);const n=function(i){return{clickable:i}};function D(i,m){if(1&i){const s=t.EpF();t.TgZ(0,"div",2)(1,"img",3),t.NdJ("click",function(){t.CHM(s);const d=t.oxw();return t.KtG(d.clickLogo())}),t.ALo(2,"translate"),t.qZA()()}if(2&i){const s=t.oxw();t.xp6(1),t.s9C("alt",t.lcZ(2,2,"LOGO_ARIA")),t.Q6J("ngClass",t.VKq(4,n,s.canClickLogo()))}}function I(i,m){if(1&i){const s=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(s);const d=t.oxw(2);return t.KtG(d.goBack())}),t._UZ(1,"i",14),t.qZA()}}function M(i,m){if(1&i){const s=t.EpF();t.TgZ(0,"button",15),t.NdJ("click",function(){t.CHM(s);const d=t.oxw(2);return t.KtG(d.goChangePassword())}),t._UZ(1,"i",16),t.qZA()}}function x(i,m){if(1&i){const s=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(s);const d=t.oxw(2);return t.KtG(d.goHome())}),t._UZ(1,"i",18),t.qZA()}}function O(i,m){if(1&i){const s=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(s);const d=t.oxw(2);return t.KtG(d.goLogout())}),t._UZ(1,"i",20),t.qZA()}}function L(i,m){if(1&i&&(t.TgZ(0,"nav",4)(1,"div",5),t.YNc(2,I,2,0,"button",6),t.YNc(3,M,2,0,"button",7),t.qZA(),t.TgZ(4,"div",8),t._UZ(5,"h1",9),t.qZA(),t.TgZ(6,"div",10),t.YNc(7,x,2,0,"button",11),t.YNc(8,O,2,0,"button",12),t.qZA()()),2&i){const s=t.oxw();t.xp6(2),t.Q6J("ngIf",s.showBackBtn),t.xp6(1),t.Q6J("ngIf",s.showChangePasswordBtn),t.xp6(2),t.Q6J("innerHtml",s.title,t.oJD),t.xp6(2),t.Q6J("ngIf",s.showHomeBtn),t.xp6(1),t.Q6J("ngIf",s.showLogoutBtn)}}let Z=(()=>{class i{constructor(s,h,d,H,k,y,F){this.applicationRef=s,this.router=h,this.translate=d,this.native=H,this.appContext=k,this.config=y,this.authentication=F,this.showBackBtn=!1,this.showHomeBtn=!1,this.onHomeFun=()=>this.router.navigate(["/menu"]),this.isClinician=!1,this.title="",this.showChangePasswordBtn=!1,this.showLogoutBtn=!1,this.showLogo=!1,this.goBack=()=>{this.onBackFun?this.onBackFun():globalThis.history.back()},this.goLogout=()=>{const w=this.translate.instant("LOGOUT_CONFIRM_MSG"),P=this.translate.instant("OK"),U=this.translate.instant("CANCEL");this.native.showConfirmDialog(w,P,U,N=>{N&&(this.router.navigate(["/logout"]),setTimeout(()=>this.applicationRef.tick(),100))})},this.goChangePassword=()=>{this.router.navigate(["/change_password"])}}ngOnChanges(){this.title=this.title?this.translate.instant(this.title):""}canClickLogo(){return!!this.helpAndInfoUrl()}helpAndInfoUrl(){return this.config.getAppConfig().helpAndInfoUrl}clickLogo(){const s=this.helpAndInfoUrl();this.canClickLogo()&&void 0!==s&&this.native.openUrl(s)}goHome(){this.onHomeFun?this.onHomeFun():this.router.navigate(["/menu"])}goClinicianMenu(){this.appContext.requestParams.getAndClear("selectedPatient"),this.router.navigate(["/clinician_menu"])}}return i.\u0275fac=function(s){return new(s||i)(t.Y36(t.z2F),t.Y36(C.F0),t.Y36(_.sK),t.Y36(T.R),t.Y36(g.P),t.Y36(v.E),t.Y36(A.$))},i.\u0275cmp=t.Xpm({type:i,selectors:[["header-menu"]],inputs:{showBackBtn:"showBackBtn",onBackFun:"onBackFun",showHomeBtn:"showHomeBtn",onHomeFun:"onHomeFun",isClinician:"isClinician",title:"title",showChangePasswordBtn:"showChangePasswordBtn",showLogoutBtn:"showLogoutBtn",showLogo:"showLogo"},features:[t.TTD],decls:2,vars:2,consts:[["id","logo",4,"ngIf"],["id","header",4,"ngIf"],["id","logo"],["src","./assets/product-flavor/images/header.svg",3,"alt","ngClass","click"],["id","header"],[1,"header-left"],["id","back-button","type","button","class","button",3,"click",4,"ngIf"],["id","change-password-button","type","button","class","button",3,"click",4,"ngIf"],[1,"header-center"],["id","header-title",3,"innerHtml"],[1,"header-right"],["id","menu-button","type","button","class","button",3,"click",4,"ngIf"],["id","logout-button","type","button","class","button",3,"click",4,"ngIf"],["id","back-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-arrow-left"],["id","change-password-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-user-lock"],["id","menu-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-home"],["id","logout-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-sign-out"]],template:function(s,h){1&s&&(t.YNc(0,D,3,6,"div",0),t.YNc(1,L,9,5,"nav",1)),2&s&&(t.Q6J("ngIf",h.showLogo),t.xp6(1),t.Q6J("ngIf",!h.showLogo))},dependencies:[B.mk,B.O5,_.X$]}),i})()}}]);