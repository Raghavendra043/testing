"use strict";(self.webpackChunkopentele_client_html_angular=self.webpackChunkopentele_client_html_angular||[]).push([[898],{3898:(y,u,a)=>{a.r(u),a.d(u,{LoginModule:()=>Q});var m=a(60),l=a(3075),g=a(619),h=a(5861),L=a(2076),M=a(4815),o=a(5e3),C=a(4865),x=a(4338),_=a(4879),v=a(7166),Z=a(8507),T=a(1786);function A(n,r){if(1&n&&(o.TgZ(0,"div",25),o._UZ(1,"i",26),o._uU(2),o.ALo(3,"translate"),o.qZA()),2&n){const e=o.oxw(2);o.xp6(2),o.hij(" ",o.lcZ(3,1,e.model.error)," ")}}function E(n,r){if(1&n&&(o.TgZ(0,"div",27),o._UZ(1,"i",28),o._uU(2),o.ALo(3,"translate"),o.qZA()),2&n){const e=o.oxw(2);o.xp6(2),o.hij(" ",o.lcZ(3,1,e.model.info)," ")}}function I(n,r){1&n&&o._UZ(0,"i",29)}function J(n,r){1&n&&(o.TgZ(0,"div",30),o._uU(1),o.ALo(2,"translate"),o.qZA()),2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"LOGIN_FORM_REMEMBER_ME_DISCLAIMER")," "))}const N=function(n){return{padding_when_notification:n}},c=function(n){return{warning:n}};function O(n,r){if(1&n){const e=o.EpF();o.TgZ(0,"form",4,5),o.NdJ("ngSubmit",function(){o.CHM(e);const i=o.oxw();return o.KtG(i.submit())}),o.YNc(2,A,4,3,"div",6),o.YNc(3,E,4,3,"div",7),o.TgZ(4,"div",8)(5,"div",9)(6,"div",10),o._UZ(7,"i",11),o.TgZ(8,"input",12,13),o.NdJ("ngModelChange",function(i){o.CHM(e);const t=o.oxw();return o.KtG(t.model.username=i)}),o.ALo(10,"translate"),o.qZA()(),o.TgZ(11,"div",10),o._UZ(12,"i",14),o.TgZ(13,"input",15,16),o.NdJ("ngModelChange",function(i){o.CHM(e);const t=o.oxw();return o.KtG(t.model.password=i)}),o.ALo(15,"translate"),o.qZA()(),o.TgZ(16,"div",17)(17,"button",18),o._uU(18),o.ALo(19,"translate"),o.YNc(20,I,1,0,"i",19),o.qZA()()(),o.TgZ(21,"div",20)(22,"label",21),o._uU(23),o.ALo(24,"translate"),o.qZA(),o.TgZ(25,"input",22,23),o.NdJ("ngModelChange",function(i){o.CHM(e);const t=o.oxw();return o.KtG(t.model.rememberMe=i)}),o.qZA(),o.YNc(27,J,3,3,"div",24),o.qZA()()()}if(2&n){const e=o.MAs(1),s=o.MAs(9),i=o.MAs(14),t=o.oxw();o.Q6J("ngClass",o.VKq(25,N,t.model.error)),o.xp6(2),o.Q6J("ngIf",t.model.error),o.xp6(1),o.Q6J("ngIf",t.model.info),o.xp6(3),o.Q6J("ngClass",o.VKq(27,c,!s.valid&&!s.pristine)),o.xp6(1),o.Q6J("ngClass",o.VKq(29,c,!s.valid&&!s.pristine)),o.xp6(1),o.s9C("placeholder",o.lcZ(10,17,"LOGIN_FORM_USERNAME")),o.Q6J("ngModel",t.model.username),o.xp6(3),o.Q6J("ngClass",o.VKq(31,c,!i.valid&&!i.pristine)),o.xp6(1),o.Q6J("ngClass",o.VKq(33,c,!i.valid&&!i.pristine)),o.xp6(1),o.s9C("placeholder",o.lcZ(15,19,"LOGIN_FORM_PASSWORD")),o.Q6J("ngModel",t.model.password),o.xp6(4),o.Q6J("disabled",!e.form.valid||"Loading"===t.model.state),o.xp6(1),o.hij(" ","Loading"!==t.model.state?o.lcZ(19,21,"LOGIN_LOGIN_BUTTON"):""," "),o.xp6(2),o.Q6J("ngIf","Loading"===t.model.state),o.xp6(3),o.hij(" ",o.lcZ(24,23,"LOGIN_FORM_REMEMBER_ME")," "),o.xp6(2),o.Q6J("ngModel",t.model.rememberMe),o.xp6(2),o.Q6J("ngIf",t.model.rememberMe)}}const w=[{path:"",component:(()=>{class n{constructor(e,s,i,t,d){this.userSession=e,this.appContext=s,this.authentication=i,this.router=t,this.idle=d,this.model={showPopup:!1,showLoginForm:!1,rememberMe:!1,state:"Initial"}}ngOnInit(){var e=this;return(0,h.Z)(function*(){e.stopIdleWatcher(),e.setupErrorMessage(),(0,L.D)(e.userSession.init());try{const s=yield e.userSession.init();e.root=s,e.userSession.startSilentLogin(s,i=>e.loginFailed(e,i))}catch(s){e.connectionError()}})()}loginFailed(e,s){var i;const t=s.status,d=s.data;if(e.model.showLoginForm=!0,t&&t>-1)if(401===t)if("PASSWORD_EXPIRED"===d.code){const f={username:e.model.username,changePasswordUrl:null===(i=e.root)||void 0===i?void 0:i.links.auth};e.appContext.requestParams.set("userInfo",f),e.appContext.requestParams.set("forceChange",!0),e.router.navigate(["/change_password"])}else delete e.model.password,e.model.error=d.code;else e.model.error="OPENTELE_DOWN_TEXT";this.model.state="Loaded"}submit(){this.model.state="Loading";const e=this.root;void 0!==e&&void 0!==this.model.username&&void 0!==this.model.password&&this.authentication.login(e.links.auth,{username:this.model.username,password:this.model.password},this.model.rememberMe).subscribe(t=>{if("data"in t)return void this.loginFailed(this,t);const{claims:d,canChangePassword:f,logoutUrl:U,organizations:b}=t;this.userSession.completeLogin(e,d,f,U,b).then(()=>{const p=M.V$.get();p&&(this.model.info=p),this.model.state="Loaded"})})}setupErrorMessage(){const e="authenticationError";this.model.error=this.appContext.requestParams.containsKey(e)?this.appContext.requestParams.getAndClear(e):""}connectionError(){this.model.error="OPENTELE_UNAVAILABLE_TEXT"}stopIdleWatcher(){this.idle.isRunning()&&this.idle.stop()}}return n.\u0275fac=function(e){return new(e||n)(o.Y36(C.o),o.Y36(x.P),o.Y36(_.$),o.Y36(g.F0),o.Y36(v.hX))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-login"]],decls:4,vars:2,consts:[[1,"container"],[3,"showLogo"],[1,"content","space_between"],["id","login-form","class","login_form","autocomplete","off","autocorrect","off","autocapitalize","off",3,"ngClass","ngSubmit",4,"ngIf"],["id","login-form","autocomplete","off","autocorrect","off","autocapitalize","off",1,"login_form",3,"ngClass","ngSubmit"],["loginForm","ngForm"],["class","notification error",4,"ngIf"],["id","login-info","class","notification info",4,"ngIf"],[1,"fill"],["id","input-container"],[1,"login_input",3,"ngClass"],[1,"fal","fa-user",3,"ngClass"],["id","username","required","","focusOnLoad","","name","username","type","text","autocomplete","off","autocorrect","off","autocapitalize","off",3,"ngModel","placeholder","ngModelChange"],["username","ngModel"],[1,"fal","fa-lock-alt",3,"ngClass"],["id","password","name","password","required","","type","text","autocomplete","off","autocorrect","off","autocapitalize","off",1,"password",3,"ngModel","placeholder","ngModelChange"],["password","ngModel"],[1,"button_container"],["type","submit",3,"disabled"],["class","fa fa-spinner fa-spin",4,"ngIf"],["id","info-box-container"],["for","remember-me"],["id","remember-me","name","rememberMe","type","checkbox",3,"ngModel","ngModelChange"],["rememberMe","ngModel"],["id","disclaimer-text",4,"ngIf"],[1,"notification","error"],[1,"notification_icon","fas","fa-exclamation-triangle"],["id","login-info",1,"notification","info"],[1,"notification_icon","fas","fa-info-circle"],[1,"fa","fa-spinner","fa-spin"],["id","disclaimer-text"]],template:function(e,s){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"header-menu",1),o.TgZ(2,"div",2),o.YNc(3,O,28,35,"form",3),o.qZA()()),2&e&&(o.xp6(1),o.Q6J("showLogo",!0),o.xp6(2),o.Q6J("ngIf",s.model.showLoginForm))},dependencies:[m.mk,m.O5,l._Y,l.Fj,l.Wl,l.JJ,l.JL,l.Q7,l.On,l.F,Z.G,T.X$]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[g.Bz.forChild(w),g.Bz]}),n})();var S=a(4466),R=a(4546);let Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[m.ez,F,l.u5,S.m,R.O]}),n})()}}]);