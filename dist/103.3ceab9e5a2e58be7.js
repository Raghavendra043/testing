"use strict";(self.webpackChunkopentele_client_html_angular=self.webpackChunkopentele_client_html_angular||[]).push([[103],{4546:(J,T,o)=>{o.d(T,{O:()=>C});var e=o(60),v=o(4466),t=o(5e3);let C=(()=>{class _{}return _.\u0275fac=function(E){return new(E||_)},_.\u0275mod=t.oAB({type:_}),_.\u0275inj=t.cJS({imports:[e.ez,v.m]}),_})()},8507:(J,T,o)=>{o.d(T,{G:()=>b});var e=o(5e3),v=o(619),t=o(1786),C=o(7362),_=o(4338),x=o(8351),E=o(4879),Z=o(60);const L=function(u){return{clickable:u}};function O(u,g){if(1&u){const a=e.EpF();e.TgZ(0,"div",2)(1,"img",3),e.NdJ("click",function(){e.CHM(a);const h=e.oxw();return e.KtG(h.clickLogo())}),e.ALo(2,"translate"),e.qZA()()}if(2&u){const a=e.oxw();e.xp6(1),e.s9C("alt",e.lcZ(2,2,"LOGO_ARIA")),e.Q6J("ngClass",e.VKq(4,L,a.canClickLogo()))}}function U(u,g){if(1&u){const a=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(a);const h=e.oxw(2);return e.KtG(h.goBack())}),e._UZ(1,"i",14),e.qZA()}}function I(u,g){if(1&u){const a=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(a);const h=e.oxw(2);return e.KtG(h.goChangePassword())}),e._UZ(1,"i",16),e.qZA()}}function w(u,g){if(1&u){const a=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(a);const h=e.oxw(2);return e.KtG(h.goHome())}),e._UZ(1,"i",18),e.qZA()}}function P(u,g){if(1&u){const a=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(a);const h=e.oxw(2);return e.KtG(h.goLogout())}),e._UZ(1,"i",20),e.qZA()}}function q(u,g){if(1&u&&(e.TgZ(0,"nav",4)(1,"div",5),e.YNc(2,U,2,0,"button",6),e.YNc(3,I,2,0,"button",7),e.qZA(),e.TgZ(4,"div",8),e._UZ(5,"h1",9),e.qZA(),e.TgZ(6,"div",10),e.YNc(7,w,2,0,"button",11),e.YNc(8,P,2,0,"button",12),e.qZA()()),2&u){const a=e.oxw();e.xp6(2),e.Q6J("ngIf",a.showBackBtn),e.xp6(1),e.Q6J("ngIf",a.showChangePasswordBtn),e.xp6(2),e.Q6J("innerHtml",a.title,e.oJD),e.xp6(2),e.Q6J("ngIf",a.showHomeBtn),e.xp6(1),e.Q6J("ngIf",a.showLogoutBtn)}}let b=(()=>{class u{constructor(a,m,h,M,B,k,R){this.applicationRef=a,this.router=m,this.translate=h,this.native=M,this.appContext=B,this.config=k,this.authentication=R,this.showBackBtn=!1,this.showHomeBtn=!1,this.onHomeFun=()=>this.router.navigate(["/menu"]),this.isClinician=!1,this.title="",this.showChangePasswordBtn=!1,this.showLogoutBtn=!1,this.showLogo=!1,this.goBack=()=>{this.onBackFun?this.onBackFun():globalThis.history.back()},this.goLogout=()=>{const N=this.translate.instant("LOGOUT_CONFIRM_MSG"),S=this.translate.instant("OK"),F=this.translate.instant("CANCEL");this.native.showConfirmDialog(N,S,F,H=>{H&&(this.router.navigate(["/logout"]),setTimeout(()=>this.applicationRef.tick(),100))})},this.goChangePassword=()=>{this.router.navigate(["/change_password"])}}ngOnChanges(){this.title=this.title?this.translate.instant(this.title):""}canClickLogo(){return!!this.helpAndInfoUrl()}helpAndInfoUrl(){return this.config.getAppConfig().helpAndInfoUrl}clickLogo(){const a=this.helpAndInfoUrl();this.canClickLogo()&&void 0!==a&&this.native.openUrl(a)}goHome(){this.onHomeFun?this.onHomeFun():this.router.navigate(["/menu"])}goClinicianMenu(){this.appContext.requestParams.getAndClear("selectedPatient"),this.router.navigate(["/clinician_menu"])}}return u.\u0275fac=function(a){return new(a||u)(e.Y36(e.z2F),e.Y36(v.F0),e.Y36(t.sK),e.Y36(C.R),e.Y36(_.P),e.Y36(x.E),e.Y36(E.$))},u.\u0275cmp=e.Xpm({type:u,selectors:[["header-menu"]],inputs:{showBackBtn:"showBackBtn",onBackFun:"onBackFun",showHomeBtn:"showHomeBtn",onHomeFun:"onHomeFun",isClinician:"isClinician",title:"title",showChangePasswordBtn:"showChangePasswordBtn",showLogoutBtn:"showLogoutBtn",showLogo:"showLogo"},features:[e.TTD],decls:2,vars:2,consts:[["id","logo",4,"ngIf"],["id","header",4,"ngIf"],["id","logo"],["src","./assets/product-flavor/images/header.svg",3,"alt","ngClass","click"],["id","header"],[1,"header-left"],["id","back-button","type","button","class","button",3,"click",4,"ngIf"],["id","change-password-button","type","button","class","button",3,"click",4,"ngIf"],[1,"header-center"],["id","header-title",3,"innerHtml"],[1,"header-right"],["id","menu-button","type","button","class","button",3,"click",4,"ngIf"],["id","logout-button","type","button","class","button",3,"click",4,"ngIf"],["id","back-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-arrow-left"],["id","change-password-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-user-lock"],["id","menu-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-home"],["id","logout-button","type","button",1,"button",3,"click"],["aria-hidden","true",1,"fal","fa-sign-out"]],template:function(a,m){1&a&&(e.YNc(0,O,3,6,"div",0),e.YNc(1,q,9,5,"nav",1)),2&a&&(e.Q6J("ngIf",m.showLogo),e.xp6(1),e.Q6J("ngIf",!m.showLogo))},dependencies:[Z.mk,Z.O5,t.X$]}),u})()},8103:(J,T,o)=>{o.r(T),o.d(T,{QuestionnaireResultsModule:()=>K});var e=o(60),v=o(619),t=o(5e3),C=o(4338),_=o(8351),x=o(9808),E=o(520);let Z=(()=>{class s{constructor(n){this.http=n,this.list=i=>{const c=i.indexOf("?")>0?`${i}&order=desc`:`${i}?order=desc`;return(0,x.n)(this.http.get(c))},this.show=i=>(0,x.n)(this.http.get(i.links.questionnaireResult))}}return s.\u0275fac=function(n){return new(n||s)(t.LFG(E.eN))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var L=o(8507),O=o(9797),U=o(1786),I=o(4679),w=o(2313);let P=(()=>{class s{constructor(n,i,c,f){this.translate=n,this.utils=i,this.sanitizer=c,this.element=f,this.handleMeasurementsReply=p=>p.measurements.filter(l=>this.utils.exists(l.measurement)).map(l=>{const r=l.measurement,Q=`${this.translate.instant(`MEASUREMENT_TYPE_${l.type.toUpperCase()}`)}:`;let D="-"!==r.unit?r.unit:"",A="",y="";switch(l.type){case"copd_prediction":return"";case"blood_pressure":"systolic"in r&&(A=`${r.systolic}/${r.diastolic}`);break;case"bloodsugar":case"bloodsugar_mg_dl":"isAfterMeal"in r&&(A=s.toDecimals(r.value,1),!0===r.isAfterMeal&&(y=`<br/>(${this.translate.instant("AFTER_MEAL")})`),!0===r.isBeforeMeal&&(y=`<br/>(${this.translate.instant("BEFORE_MEAL")})`),!0===r.isFasting&&(y=`<br/>(${this.translate.instant("FASTING")})`));break;case"ecg":A="-",D="";break;default:"value"in r?A=`${r.value}`:(A=this.translate.instant("NO_VALUE"),D="")}return`${Q} ${A} ${D} ${y}`.trim()}).join("<br/>")}ngOnInit(){this.reply&&(this.element.nativeElement.innerHTML=this.generateHtml(this.reply))}wrapInSpan(n){return`<span class="reply-table-value">${n}</span>`}sanitize(n){var i;return null!==(i=this.sanitizer.sanitize(t.q3G.HTML,n))&&void 0!==i?i:""}handleInputReply(n){if(this.utils.exists(n.patientAnswer))return this.wrapInSpan(this.sanitize(n.patientAnswer));if("boolean"==typeof n.answer){const i=this.translate.instant(n.answer?"YES":"NO");return this.wrapInSpan(this.sanitize(i))}return this.wrapInSpan(this.sanitize(String(n.answer)))}handleOmittedReply(){return this.wrapInSpan(this.translate.instant("OMITTED"))}static toDecimals(n,i){return(Math.round(100*n)/100).toFixed(i)}generateHtml(n){return this.utils.exists(n)?"omitted"in n?this.handleOmittedReply():"answer"in n?this.handleInputReply(n):"measurements"in n?this.handleMeasurementsReply(n):this.wrapInSpan("-"):this.wrapInSpan("")}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(U.sK),t.Y36(I.c),t.Y36(w.H7),t.Y36(t.SBq))},s.\u0275dir=t.lG2({type:s,selectors:[["","prettyReply",""]],inputs:{reply:"reply"}}),s})();var q=o(6793),b=o(8348);const u=function(s){return{"hide-comment-icon":s}};function g(s,d){if(1&s){const n=t.EpF();t.TgZ(0,"tr",12),t.NdJ("click",function(){const f=t.CHM(n).$implicit,p=t.oxw(2);return t.KtG(p.showPopUp(f))}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"span",13),t._UZ(5,"i",14),t.ALo(6,"severity"),t.TgZ(7,"span",15),t._UZ(8,"i",16),t.qZA()(),t._UZ(9,"span",17),t.qZA()()}if(2&s){const n=d.$implicit,i=t.oxw(2);t.xp6(2),t.hij(" ",n.patientText," "),t.xp6(3),t.Q6J("ngClass",t.xi3(6,4,n.severity,i.showSeverity)),t.xp6(2),t.Q6J("ngClass",t.VKq(7,u,!i.hasComment(n))),t.xp6(2),t.Q6J("reply",null==n?null:n.reply)}}function a(s,d){if(1&s&&(t.TgZ(0,"div")(1,"h1",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",7)(5,"div",8)(6,"span"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"amDateFormat"),t.qZA()(),t.TgZ(10,"div",9)(11,"table",10)(12,"thead")(13,"tr")(14,"th"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"th"),t._uU(18),t.ALo(19,"translate"),t.qZA()()(),t.TgZ(20,"tbody"),t.YNc(21,g,10,9,"tr",11),t.qZA(),t.TgZ(22,"tfoot")(23,"tr"),t._UZ(24,"td")(25,"td"),t.qZA()()()()()()),2&s){const n=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,6,n.questionnaireResult.name)," "),t.xp6(5),t.AsE(" ",t.lcZ(8,8,"SUBMISSION_DATE"),": ",t.xi3(9,10,n.questionnaireResult.resultDate,"ll")," "),t.xp6(8),t.Oqu(t.lcZ(16,13,"QUESTION")),t.xp6(3),t.Oqu(t.lcZ(19,15,"REPLY")),t.xp6(3),t.Q6J("ngForOf",n.questionnaireResult.questions)}}function m(s,d){if(1&s){const n=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.hidePopUp())}),t.TgZ(1,"div",19)(2,"h3"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"table",20)(6,"tr")(7,"td",21),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA()(),t.TgZ(12,"tr")(13,"td",21),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"td"),t._UZ(17,"span",17),t.qZA()(),t.TgZ(18,"tr")(19,"td",21),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.qZA()()(),t.TgZ(24,"div",22)(25,"button",23),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.hidePopUp())}),t._uU(26),t.ALo(27,"translate"),t._UZ(28,"i",24),t.qZA()()()()}if(2&s){const n=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,8,"COMMENT")),t.xp6(5),t.hij("",t.lcZ(9,10,"TIMESTAMP"),":"),t.xp6(3),t.hij(" ",n.popUpQuestion.timestamp," "),t.xp6(3),t.hij("",t.lcZ(15,12,"VALUE"),":"),t.xp6(3),t.Q6J("reply",n.popUpQuestion.reply),t.xp6(3),t.hij("",t.lcZ(21,14,"COMMENT"),":"),t.xp6(3),t.Oqu(n.popUpQuestion.comment),t.xp6(3),t.hij(" ",t.lcZ(27,16,"CLOSE")," ")}}let h=(()=>{class s{constructor(n,i,c,f){this.appContext=n,this.config=i,this.questionnaireResultsService=c,this.router=f,this.state="Loading";const p=this.appContext.requestParams;this.hasOtherResults=p.get(M.hasOtherQuestionnaireResults),this.showSeverity=this.config.getAppConfig().showSeverity;const l=p.get(M.selectedQuestionnaireResult);this.questionnaireResultsService.show(l).then(r=>(this.questionnaireResult=r,this.state="Loaded",r)).catch(r=>{this.state="Failed",console.error(`Failed to load questionnaire result due to error: ${r}`)})}ngOnInit(){this.appContext.requestParams.containsKey(M.selectedQuestionnaireResult)||this.router.navigate(["/menu"])}showPopUp(n){if(this.hasMeasurementReply(n)){const i=this.timestampedComment(n.reply);void 0!==i&&(this.popUpQuestion=Object.assign(Object.assign({},n),i))}}hidePopUp(){delete this.popUpQuestion}hasMeasurementReply(n){return void 0!==n.reply.measurements}timestampedComment(n){const i=n.measurements.find(this.hasComment);return i&&{comment:i.comment,timestamp:i.timestamp}}hasComment(n){return void 0!==n.comment&&""!==n.comment}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(C.P),t.Y36(_.E),t.Y36(Z),t.Y36(v.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-questionnaire-result"]],decls:6,vars:8,consts:[[1,"container","white"],[3,"showBackBtn","showHomeBtn","title"],[1,"content"],[3,"stateModel","loadingMessage","failedMessage"],[4,"ngIf"],["class","light-box-dimmer",3,"click",4,"ngIf"],[1,"graph_headline"],["id","graphs_and_table"],[1,"submission_date"],[1,"my_results_table"],["id","table",2,"table-layout","unset"],["id","questionnaire-result-item",3,"click",4,"ngFor","ngForOf"],["id","questionnaire-result-item",3,"click"],[1,"severity-and-comment"],["aria-hidden","true",1,"fas","fa-circle",3,"ngClass"],[1,"comment-icon",3,"ngClass"],["aria-hidden","true",1,"far","fa-sticky-note"],["prettyReply","",3,"reply"],[1,"light-box-dimmer",3,"click"],["id","light-box",1,"light-box"],[1,"measurement-info-table"],[1,"row-header"],["id","action-buttons",1,"flex-column"],[1,"footer-button","center-button",3,"click"],["aria-hidden","true",1,"icon","fas","fa-times-circle"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"header-menu",1),t.TgZ(2,"div",2),t._UZ(3,"loading-state",3),t.YNc(4,a,26,17,"div",4),t.YNc(5,m,29,18,"div",5),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("showBackBtn",!0)("showHomeBtn",!!i.hasOtherResults)("title","QUESTIONNAIRE_RESULT_TITLE"),t.xp6(2),t.Q6J("stateModel",i.state)("loadingMessage","QUESTIONNAIRE_RESULT_LOADING")("failedMessage","QUESTIONNAIRE_RESULT_FAILED"),t.xp6(1),t.Q6J("ngIf",i.questionnaireResult),t.xp6(1),t.Q6J("ngIf",i.popUpQuestion))},dependencies:[e.mk,e.sg,e.O5,L.G,O.X,P,q.h,U.X$,b.Ek]}),s})();const M=Object.freeze({selectedQuestionnaireResult:"selectedQuestionnaireResult",hasOtherQuestionnaireResults:"hasOtherQuestionnaireResults"});function B(s,d){if(1&s){const n=t.EpF();t.TgZ(0,"a",8),t.NdJ("click",function(){const c=t.CHM(n),f=c.$implicit,p=c.index,l=t.oxw();return t.KtG(l.showQuestionnaireResult(f,p))}),t.TgZ(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",9),t._uU(5),t.ALo(6,"amDateFormat"),t.qZA()()}if(2&s){const n=d.$implicit;t.hYB("id","",n.name," ",n.resultDate,""),t.xp6(2),t.Oqu(t.lcZ(3,4,n.name)),t.xp6(3),t.hij(" ",t.xi3(6,6,n.resultDate,"lll")," ")}}let k=(()=>{class s{constructor(n,i,c){this.appContext=n,this.questionnaireResultsService=i,this.router=c,this.model={questionnaireResults:[],pagination:void 0,state:"Loading"},this.showQuestionnaireResult=(l,r)=>{this.requestParams.set(R.selectedQuestionnaireResult,l),this.requestParams.set(R.hasOtherQuestionnaireResults,this.model.questionnaireResults.length>1),1===this.model.questionnaireResults.length?this.router.navigate(["/questionnaire_results/"+r+"/questionnaire_result"],{replaceUrl:!0}):this.router.navigate(["/questionnaire_results/"+r+"/questionnaire_result"])},this.nextPage=()=>{var l;this.model.state="Loading";const r=null===(l=this.model.pagination)||void 0===l?void 0:l.next;r&&this.showPage(r,!1)},this.previousPage=()=>{var l;this.model.state="Loading";const r=null===(l=this.model.pagination)||void 0===l?void 0:l.previous;r&&this.showPage(r,!1)},this.onSuccess=(l,r,Q)=>{this.model.state="Loaded",this.model.questionnaireResults=l.results,this.model.pagination=l.links,r&&1===this.model.questionnaireResults.length&&this.showQuestionnaireResult(this.model.questionnaireResults[0],0),this.requestParams.set(R.questionnaireResultsPage,Q)},this.onError=l=>{this.model.state="Failed",console.error(`Failed to load questionnaire results due to error: ${l}`)},this.showPage=(l,r)=>this.questionnaireResultsService.list(l).then(Q=>{this.onSuccess(Q,r,l)}).catch(this.onError),this.model={questionnaireResults:[],pagination:{self:""},state:"Loading"};const p=this.appContext.getUser();this.requestParams=this.appContext.requestParams,this.requestParams.containsKey(R.questionnaireResultsPage)?this.showPage(this.requestParams.getAndClear(R.questionnaireResultsPage),!1):void 0!==(null==p?void 0:p.links.questionnaireResults)&&this.showPage(p.links.questionnaireResults,!0)}}return s.\u0275fac=function(n){return new(n||s)(t.Y36(C.P),t.Y36(Z),t.Y36(v.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-questionnaire-results"]],decls:12,vars:16,consts:[[1,"container"],[3,"showBackBtn","title"],[3,"stateModel","hasNoData","noDataMessage","loadingMessage","failedMessage"],[1,"content"],["class","flex_list list_item normal_list_item condensed_list_item",3,"id","click",4,"ngFor","ngForOf"],["id","footer",1,"flex-column"],["id","question-left-button",1,"footer-button","left-button",3,"disabled","click"],["id","question-right-button","type","button",1,"footer-button","right-button",3,"disabled","click"],[1,"flex_list","list_item","normal_list_item","condensed_list_item",3,"id","click"],[1,"result-date"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"header-menu",1)(2,"loading-state",2),t.TgZ(3,"nav",3),t.YNc(4,B,7,9,"a",4),t.qZA(),t.TgZ(5,"div",5)(6,"button",6),t.NdJ("click",function(){return i.previousPage()}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return i.nextPage()}),t._uU(10),t.ALo(11,"translate"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("showBackBtn",!0)("title","QUESTIONNAIRE_RESULTS_TITLE"),t.xp6(1),t.Q6J("stateModel",i.model.state)("hasNoData",0===i.model.questionnaireResults.length)("noDataMessage","NO_QUESTIONNAIRE_RESULTS_AVAILABLE")("loadingMessage","QUESTIONNAIRE_RESULTS_LOADING")("failedMessage","QUESTIONNAIRE_RESULTS_FAILED"),t.xp6(2),t.Q6J("ngForOf",i.model.questionnaireResults),t.xp6(2),t.Q6J("disabled",!(null!=i.model.pagination&&i.model.pagination.previous)),t.xp6(1),t.hij(" ",t.lcZ(8,12,"NEWER")," "),t.xp6(2),t.Q6J("disabled",!(null!=i.model.pagination&&i.model.pagination.next)),t.xp6(1),t.hij(" ",t.lcZ(11,14,"OLDER")," "))},dependencies:[e.sg,L.G,O.X,U.X$,b.Ek]}),s})();const R=Object.freeze({selectedQuestionnaireResult:"selectedQuestionnaireResult",hasOtherQuestionnaireResults:"hasOtherQuestionnaireResults",questionnaireResultsPage:"questionnaireResultsPage"}),N=[{path:"",component:k},{path:":id/questionnaire_result",component:h}];let S=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[v.Bz.forChild(N),v.Bz]}),s})();var F=o(4546),H=o(4466),Y=o(9017);let K=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[S,e.ez,F.O,H.m,Y.I]}),s})()}}]);